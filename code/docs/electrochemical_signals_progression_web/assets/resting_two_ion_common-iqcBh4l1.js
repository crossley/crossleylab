var mt=Object.defineProperty;var bt=(n,e,h)=>e in n?mt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:h}):n[e]=h;var it=(n,e,h)=>bt(n,typeof e!="symbol"?e+"":e,h);import"./style-WLU6Igt5.js";class xt{constructor(e){it(this,"state");it(this,"spare",null);this.state=e>>>0||1}next(){let e=this.state;return e^=e<<13,e^=e>>>17,e^=e<<5,this.state=e>>>0,this.state/4294967296}uniform(e,h){return e+(h-e)*this.next()}normal(e=0,h=1){if(this.spare!==null){const u=this.spare;return this.spare=null,e+h*u}let w=0,x=0;for(;w<=Number.EPSILON;)w=this.next();for(;x<=Number.EPSILON;)x=this.next();const c=Math.sqrt(-2*Math.log(w)),R=c*Math.cos(2*Math.PI*x),t=c*Math.sin(2*Math.PI*x);return this.spare=t,e+h*R}}function s(n,e,h){return Math.min(h,Math.max(e,n))}function at(){return Math.random()*4294967295>>>0}function d(n){const e=document.querySelector(n);if(!e)throw new Error(`Missing ${n}`);return e}function v(n,e,h=3){n.value=Number.isInteger(e)?String(e):Number(e.toFixed(h)).toString()}function pt(n,e,h){const w=h/2,x=s(Math.min(n,e),-w,w),c=s(Math.max(n,e),-w,w);return c-x<.5?[x,Math.min(w,x+.5)]:[x,c]}function vt(n,e,h,w,x,c,R){const t=window.devicePixelRatio||1,u=n.getBoundingClientRect(),i=Math.max(1,Math.round(u.width*t)),a=Math.max(1,Math.round(u.height*t));(n.width!==i||n.height!==a)&&(n.width=i,n.height=a);const l=n.getContext("2d");if(!l)return;l.clearRect(0,0,i,a),l.fillStyle="#03060b",l.fillRect(0,0,i,a),l.strokeStyle="rgba(120,170,255,0.10)",l.lineWidth=1;for(let g=1;g<10;g+=1){const p=i*g/10,b=a*g/10;l.beginPath(),l.moveTo(p,0),l.lineTo(p,a),l.stroke(),l.beginPath(),l.moveTo(0,b),l.lineTo(i,b),l.stroke()}const M=36*t,r=10*t,P=18*t,Y=18*t,F=Math.max(1,i-M-r),k=Math.max(1,a-P-Y),W=g=>M+g/Math.max(1e-6,x)*F,f=g=>P+(1-(g+c)/Math.max(1e-6,2*c))*k;l.strokeStyle="rgba(180,220,255,0.28)",l.lineWidth=1*t,l.strokeRect(M,P,F,k),l.beginPath(),l.moveTo(M,f(0)),l.lineTo(M+F,f(0)),l.stroke();const S=s(h,0,e.length-1);for(const g of w){l.save(),l.strokeStyle=g.color,l.lineWidth=1.5*t,g.dashed&&l.setLineDash([5*t,4*t]),l.beginPath();for(let p=0;p<=S;p+=1){const b=W(e[p]),T=f(g.data[p]);p===0?l.moveTo(b,T):l.lineTo(b,T)}l.stroke(),l.restore()}l.fillStyle="rgba(232,243,255,0.92)",l.font=`${12*t}px Avenir Next, Segoe UI, sans-serif`,l.fillText(R,12*t,14*t)}function Mt(n,e,h,w,x){const c=window.devicePixelRatio||1,R=n.getBoundingClientRect(),t=Math.max(1,Math.round(R.width*c)),u=Math.max(1,Math.round(R.height*c));(n.width!==t||n.height!==u)&&(n.width=t,n.height=u);const i=n.getContext("2d");if(!i)return;i.clearRect(0,0,t,u),i.fillStyle="#03060b",i.fillRect(0,0,t,u),i.strokeStyle="rgba(120,170,255,0.10)",i.lineWidth=1;for(let f=1;f<10;f+=1){const S=t*f/10,g=u*f/10;i.beginPath(),i.moveTo(S,0),i.lineTo(S,u),i.stroke(),i.beginPath(),i.moveTo(0,g),i.lineTo(t,g),i.stroke()}const a=(f,S)=>[(f+e.boxWidth/2)/e.boxWidth*t,u-(S+e.boxHeight/2)/e.boxHeight*u],[l]=a(e.leftWall,0),[M]=a(e.rightWall,0);i.fillStyle="rgba(200,220,255,0.08)",i.fillRect(l,0,M-l,u);const[,r]=a(0,e.type0YMax),[,P]=a(0,e.type0YMin),[,Y]=a(0,e.type1YMax),[,F]=a(0,e.type1YMin);i.fillStyle="rgba(245,178,72,0.14)",i.fillRect(l,r,M-l,P-r),i.fillStyle=x.type1Color==="#72ffb2"?"rgba(114,255,178,0.14)":"rgba(66,200,255,0.14)",i.fillRect(l,Y,M-l,F-Y),i.strokeStyle="rgba(190,225,255,0.45)",i.lineWidth=1.5*c;for(const f of[e.leftWall,e.rightWall]){const[S]=a(f,0),g=[[e.type0YMin,e.type0YMax],[e.type1YMin,e.type1YMax]].sort((b,T)=>b[0]-T[0]);let p=-e.boxHeight/2;for(const[b,T]of g){if(b>p){const[,V]=a(0,p),[,H]=a(0,b);i.beginPath(),i.moveTo(S,V),i.lineTo(S,H),i.stroke()}p=Math.max(p,T)}if(p<e.boxHeight/2){const[,b]=a(0,p),[,T]=a(0,e.boxHeight/2);i.beginPath(),i.moveTo(S,b),i.lineTo(S,T),i.stroke()}}if(x.fieldMode==="point"){const[f,S]=a(e.negX,e.negY);i.fillStyle="rgba(255,96,96,0.95)",i.beginPath(),i.arc(f,S,4*c,0,Math.PI*2),i.fill()}else{const[f]=a(e.negX,0);i.strokeStyle="rgba(255,96,96,0.85)",i.lineWidth=1.5*c,i.setLineDash([5*c,4*c]),i.beginPath(),i.moveTo(f,0),i.lineTo(f,u),i.stroke(),i.setLineDash([])}const k=s(h,0,e.frames-1)*e.numParticles,W=Math.max(.8,w)*c;for(let f=0;f<e.numParticles;f+=1){const[S,g]=a(e.x[k+f],e.y[k+f]),p=e.types[f];i.fillStyle=p===0?"rgba(245,178,72,0.92)":x.type1Color,i.beginPath(),i.arc(S,g,W,0,Math.PI*2),i.fill()}i.fillStyle="rgba(232,243,255,0.92)",i.font=`${12*c}px Avenir Next, Segoe UI, sans-serif`,i.fillText(x.title,12*c,14*c)}function ut(n,e,h){const w=s(Math.round(n.T),50,2e4),x=s(n.dt,.05,20),c=s(Math.round(n.numParticles),10,300),R=s(n.type0Fraction,0,1),t=s(n.boxWidth,40,500),u=s(n.boxHeight,40,500),i=s(n.wallThickness,.5,Math.min(50,t-2)),a=s(n.diffusionSd,0,20),l=s(n.electricStrength,0,10),M=s(n.repulsionStrength,0,10),r=s(n.initialLeftFrac,0,1),[P,Y]=pt(n.type0YMin,n.type0YMax,u),[F,k]=pt(n.type1YMin,n.type1YMax,u),W=-i/2,f=i/2,S=s(n.negX,-t/2,t/2),g=s(n.negY,-u/2,u/2),p=Math.max(2,Math.floor(w/x)),b=new Float32Array(p*c),T=new Float32Array(p*c),V=new Uint8Array(c),H=new Int8Array(c),q=new Float32Array(p),o=new Float32Array(p),_=new Float32Array(p),N=new Float32Array(p),$=h.withGoldman?new Float32Array(p):void 0,G=new xt(e);for(let m=0;m<p;m+=1)q[m]=m*x;const lt=[],st=[];for(let m=0;m<c;m+=1){const A=G.next()<R?0:1;V[m]=A,H[m]=A===0?1:-1,A===0?lt.push(m):st.push(m)}const ot=(m,A,j)=>{const U=Math.floor(m.length*r);for(let z=0;z<m.length;z+=1){const X=m[z],O=z<U;b[X]=O?G.uniform(-t/2+1,W-1):G.uniform(f+1,t/2-1),T[X]=G.uniform(A,j)}};ot(lt,P,Y),ot(st,F,k);const et=new Float32Array(c),nt=new Float32Array(c);for(let m=1;m<p;m+=1){const A=(m-1)*c,j=m*c;et.fill(0),nt.fill(0);for(let y=0;y<c;y+=1){const L=b[A+y],B=T[A+y];let Q=0,J=0;for(let C=0;C<c;C+=1){if(C===y)continue;const I=L-b[A+C],E=B-T[A+C],Z=1/(I*I+E*E+.001);Q+=I*Z,J+=E*Z}et[y]=M*Q,nt[y]=M*J}for(let y=0;y<c;y+=1){const L=b[A+y],B=T[A+y],Q=G.normal(0,a),J=G.normal(0,a);let C=0,I=0;if(h.fieldMode==="point"){const D=S-L,K=g-B,tt=Math.sqrt(D*D+K*K)+.001,ct=H[y];C=l*ct*D/tt,I=l*ct*K/tt}else{const D=S-L,K=Math.abs(D)+.001,tt=H[y];C=l*tt*D/K,I=0}let E=L+(Q+C+et[y])*x;const dt=s(B+(J+I+nt[y])*x,-u/2,u/2),Z=L>f&&E<=f,ft=L<W&&E>=W,rt=V[y],ht=rt===0?P:F,yt=rt===0?Y:k,gt=B>=ht&&B<=yt;(Z||ft)&&!gt&&(E=L),b[j+y]=E,T[j+y]=dt}let U=0,z=0,X=0,O=0;for(let y=0;y<c;y+=1){const L=b[j+y],B=V[y];L<W?B===0?U+=1:X+=1:L>f&&(B===0?z+=1:O+=1)}if(o[m]=U-z,_[m]=X-O,N[m]=o[m]+_[m],$){const y=Math.max(.001,Y-P),L=Math.max(.001,k-F);$[m]=Math.log((y*z+L*O+.001)/(y*U+L*X+.001))}}return{x:b,y:T,types:V,charges:H,frames:p,numParticles:c,dt:x,t:q,boxWidth:t,boxHeight:u,leftWall:W,rightWall:f,negX:S,negY:g,type0YMin:P,type0YMax:Y,type1YMin:F,type1YMax:k,VA:o,VB:_,VTotal:N,VGoldman:$}}function Yt(n){const e={T:n.defaultT??2e3,dt:n.defaultDt??1,numParticles:n.defaultNumParticles,type0Fraction:.5,boxWidth:100,boxHeight:100,wallThickness:4,diffusionSd:.5,electricStrength:n.defaultElectricStrength,repulsionStrength:n.defaultRepulsionStrength,negX:n.defaultNegX??-45,negY:0,type0YMin:30,type0YMax:31,type1YMin:-40,type1YMax:-10,initialLeftFrac:.6,goldmanScale:n.goldmanScaleDefault??20},h={pointSize:2.2,playbackSpeed:1,targetFps:30,traceYLimit:Math.max(40,n.defaultNumParticles)},w=d("#app");w.innerHTML=`
    <div class="site-shell">
      <div class="nav-line"><a href="./index.html">Back to index</a><span>•</span><span>Page: <code>${n.pageId}</code></span></div>
      <header class="page-head">
        <p class="eyebrow">Resting-Potential and Goldman-Style Extensions</p>
        <h1>${n.pageId}</h1>
        <p class="subtitle">${n.subtitle}</p>
      </header>
      <div class="sim-layout">
        <aside class="controls">
          <div class="panel">
            <div class="group">
              <p class="group-label">Basic Controls</p>
              <div class="button-row"><button id="toggle-play" class="primary">Pause</button><button id="rerun">Rerun</button><button id="reset-defaults" class="warn">Reset Defaults</button></div>
              <div class="button-row"><button id="rewind">Rewind</button><button id="random-seed">Randomize Seed</button></div>
              <div class="control-grid">
                <div class="field"><label for="num-particles">Particles</label><input id="num-particles" type="number" min="10" max="300" step="1" /></div>
                <div class="field"><label for="type0-fraction">Type 0 fraction</label><input id="type0-fraction" type="number" min="0" max="1" step="0.01" /></div>
                <div class="field"><label for="diffusion-sd">Diffusion SD</label><input id="diffusion-sd" type="number" min="0" max="20" step="0.05" /></div>
                <div class="field"><label for="electric-strength">Electric strength</label><input id="electric-strength" type="number" min="0" max="10" step="0.01" /></div>
                <div class="field"><label for="repulsion-strength">Repulsion strength</label><input id="repulsion-strength" type="number" min="0" max="10" step="0.01" /></div>
                <div class="field"><label for="type0-y-min">Type 0 y min</label><input id="type0-y-min" type="number" step="0.5" /></div>
                <div class="field"><label for="type0-y-max">Type 0 y max</label><input id="type0-y-max" type="number" step="0.5" /></div>
                <div class="field"><label for="type1-y-min">Type 1 y min</label><input id="type1-y-min" type="number" step="0.5" /></div>
                <div class="field"><label for="type1-y-max">Type 1 y max</label><input id="type1-y-max" type="number" step="0.5" /></div>
                <div class="field"><label for="playback-speed">Playback speed</label><input id="playback-speed" type="number" min="0.1" max="8" step="0.1" /></div>
                <div class="field"><label for="seed">Seed</label><input id="seed" type="number" min="0" max="4294967295" step="1" /></div>
              </div>
            </div>
            <details><summary>Advanced Controls</summary><div class="group" style="margin-top:8px;"><div class="control-grid">
              <div class="field"><label for="total-time">Total time T (ms)</label><input id="total-time" type="number" min="50" max="20000" step="10" /></div>
              <div class="field"><label for="dt">dt (ms)</label><input id="dt" type="number" min="0.05" max="20" step="0.05" /></div>
              <div class="field"><label for="box-width">Box width</label><input id="box-width" type="number" min="40" max="500" step="1" /></div>
              <div class="field"><label for="box-height">Box height</label><input id="box-height" type="number" min="40" max="500" step="1" /></div>
              <div class="field"><label for="wall-thickness">Wall thickness</label><input id="wall-thickness" type="number" min="0.5" max="50" step="0.5" /></div>
              <div class="field"><label for="neg-x">${n.fieldMode==="point"?"Neg attractor x":"Neg wall x"}</label><input id="neg-x" type="number" step="1" /></div>
              <div class="field"><label for="neg-y">Neg y (point mode)</label><input id="neg-y" type="number" step="1" /></div>
              <div class="field"><label for="initial-left-frac">Initial left fraction</label><input id="initial-left-frac" type="number" min="0" max="1" step="0.01" /></div>
              <div class="field"><label for="trace-ylim">Trace y-limit</label><input id="trace-ylim" type="number" min="10" max="500" step="1" /></div>
              <div class="field"><label for="point-size">Point size</label><input id="point-size" type="number" min="0.5" max="8" step="0.25" /></div>
              <div class="field"><label for="target-fps">Playback FPS</label><input id="target-fps" type="number" min="1" max="120" step="1" /></div>
              ${n.withGoldman?'<div class="field"><label for="goldman-scale">Goldman trace scale</label><input id="goldman-scale" type="number" min="0" max="200" step="1" /></div>':""}
            </div></div></details>
            <div class="group"><p class="group-label">Status</p><dl class="status-list">
              <dt>Frame</dt><dd id="status-frame">0</dd><dt>Time (ms)</dt><dd id="status-time">0.0</dd>
              <dt>V_A</dt><dd id="status-va">0</dd><dt>V_B</dt><dd id="status-vb">0</dd>
              <dt>V_total</dt><dd id="status-vt">0</dd><dt>dt</dt><dd id="status-dt">0</dd>
              <dt>Step SD</dt><dd id="status-step-sd">0</dd><dt>Seed</dt><dd id="status-seed">0</dd>
            </dl></div>
            <div class="group"><p class="group-label">Equation + Trace Readout</p><div class="equation-card"><pre class="equation" id="equation-block"></pre><p>Per-ion and total compartment imbalances are qualitative Δcharge proxies. ${n.withGoldman?"Goldman line is a permeability-weighted log-ratio proxy (scaled for visualization).":""}</p></div></div>
          </div>
        </aside>
        <section class="panel canvas-panel">
          <div class="canvas-head"><h2>${n.title}</h2><span class="tiny">Qualitative browser port of <code>${n.pageId}.py</code></span></div>
          <div class="canvas-grid-2">
            <div class="canvas-subpanel"><div class="subhead"><h3>Particle Dynamics</h3><span class="tiny">${n.negMarkerLabel}</span></div><canvas id="particle-canvas"></canvas></div>
            <div class="canvas-subpanel"><div class="subhead"><h3>Membrane Potential Proxy Traces</h3><span class="tiny">V_A / V_B / V_total${n.withGoldman?" / Goldman":""}</span></div><canvas id="trace-canvas"></canvas></div>
          </div>
          <div class="legend">
            <span><span class="swatch" style="background:#f5b248"></span>Ion A (+)</span>
            <span><span class="swatch" style="background:${n.type1Color}"></span>${n.type1Label}</span>
            <span><span class="swatch" style="background:#ff6060"></span>${n.negMarkerLabel}</span>
          </div>
        </section>
      </div>
    </div>
  `;const x=d("#particle-canvas"),c=d("#trace-canvas"),R=d("#equation-block"),t={numParticles:d("#num-particles"),type0Fraction:d("#type0-fraction"),diffusionSd:d("#diffusion-sd"),electricStrength:d("#electric-strength"),repulsionStrength:d("#repulsion-strength"),type0YMin:d("#type0-y-min"),type0YMax:d("#type0-y-max"),type1YMin:d("#type1-y-min"),type1YMax:d("#type1-y-max"),playbackSpeed:d("#playback-speed"),seed:d("#seed"),totalTime:d("#total-time"),dt:d("#dt"),boxWidth:d("#box-width"),boxHeight:d("#box-height"),wallThickness:d("#wall-thickness"),negX:d("#neg-x"),negY:d("#neg-y"),initialLeftFrac:d("#initial-left-frac"),traceYLim:d("#trace-ylim"),pointSize:d("#point-size"),targetFps:d("#target-fps"),goldmanScale:n.withGoldman?d("#goldman-scale"):null},u={frame:d("#status-frame"),time:d("#status-time"),va:d("#status-va"),vb:d("#status-vb"),vt:d("#status-vt"),dt:d("#status-dt"),stepSd:d("#status-step-sd"),seed:d("#status-seed")},i={togglePlay:d("#toggle-play"),rerun:d("#rerun"),resetDefaults:d("#reset-defaults"),rewind:d("#rewind"),randomSeed:d("#random-seed")};let a={...e},l={...h},M=at(),r=ut(a,M,n),P=!0,Y=0,F=performance.now();function k(){v(t.numParticles,a.numParticles,0),v(t.type0Fraction,a.type0Fraction,2),v(t.diffusionSd,a.diffusionSd,3),v(t.electricStrength,a.electricStrength,3),v(t.repulsionStrength,a.repulsionStrength,3),v(t.type0YMin,a.type0YMin,2),v(t.type0YMax,a.type0YMax,2),v(t.type1YMin,a.type1YMin,2),v(t.type1YMax,a.type1YMax,2),v(t.playbackSpeed,l.playbackSpeed,2),v(t.seed,M,0),v(t.totalTime,a.T,0),v(t.dt,a.dt,3),v(t.boxWidth,a.boxWidth,1),v(t.boxHeight,a.boxHeight,1),v(t.wallThickness,a.wallThickness,2),v(t.negX,a.negX,1),v(t.negY,a.negY,1),v(t.initialLeftFrac,a.initialLeftFrac,2),v(t.traceYLim,l.traceYLimit,0),v(t.pointSize,l.pointSize,2),v(t.targetFps,l.targetFps,0),t.goldmanScale&&v(t.goldmanScale,a.goldmanScale,0)}function W(){var N;const o=s(Number(t.boxHeight.value)||e.boxHeight,40,500),_=s(Number(t.boxWidth.value)||e.boxWidth,40,500);return{T:s(Number(t.totalTime.value)||e.T,50,2e4),dt:s(Number(t.dt.value)||e.dt,.05,20),numParticles:s(Math.round(Number(t.numParticles.value)||e.numParticles),10,300),type0Fraction:s(Number(t.type0Fraction.value)||0,0,1),boxWidth:_,boxHeight:o,wallThickness:s(Number(t.wallThickness.value)||e.wallThickness,.5,50),diffusionSd:s(Number(t.diffusionSd.value)||0,0,20),electricStrength:s(Number(t.electricStrength.value)||0,0,10),repulsionStrength:s(Number(t.repulsionStrength.value)||0,0,10),negX:s(Number(t.negX.value)||e.negX,-_/2,_/2),negY:s(Number(t.negY.value)||e.negY,-o/2,o/2),type0YMin:s(Number(t.type0YMin.value)||0,-o/2,o/2),type0YMax:s(Number(t.type0YMax.value)||0,-o/2,o/2),type1YMin:s(Number(t.type1YMin.value)||0,-o/2,o/2),type1YMax:s(Number(t.type1YMax.value)||0,-o/2,o/2),initialLeftFrac:s(Number(t.initialLeftFrac.value)||e.initialLeftFrac,0,1),goldmanScale:n.withGoldman?s(Number((N=t.goldmanScale)==null?void 0:N.value)||e.goldmanScale,0,200):e.goldmanScale}}function f(){return{pointSize:s(Number(t.pointSize.value)||h.pointSize,.5,8),playbackSpeed:s(Number(t.playbackSpeed.value)||h.playbackSpeed,.1,8),targetFps:s(Math.round(Number(t.targetFps.value)||h.targetFps),1,120),traceYLimit:s(Number(t.traceYLim.value)||h.traceYLimit,10,500)}}function S(){const o=a.diffusionSd*a.dt,_=n.fieldMode==="point"?"attract = electric_strength · charge · (neg_pos - pos) / (||neg_pos - pos|| + ε)":"attract_x = electric_strength · charge · (neg_wall_x - x) / (|neg_wall_x - x| + ε), attract_y = 0",N=n.withGoldman?`Goldman proxy: log((P_A·A_R + P_B·B_R)/(P_A·A_L + P_B·B_L)) × ${a.goldmanScale.toFixed(0)}`:"Traces: V_A, V_B, V_total (Δcharge proxies)";R.innerHTML=['<span class="accent">Euler update (two-ion resting-potential toy model)</span>',_,"repel_j = repulsion_strength · Σ_k≠j (pos_j - pos_k) / (||pos_j - pos_k||² + ε)","x_new = x_old + (dxdt + attract_x + repel_x) · dt","y_new = clamp(y_old + (dydt + attract_y + repel_y) · dt, -H/2, H/2)","dxdt, dydt ~ Normal(0, diffusionSd²)","",'<span class="accent-2">Selective membrane gating + potential proxies</span>',"Type 0 and Type 1 have different channel windows; failed crossing attempts set x_new := x_old","V_A = (#A_left - #A_right), V_B = (#B_left - #B_right), V_total = V_A + V_B",N,"",`Per-step Brownian displacement SD = diffusionSd × dt = ${o.toFixed(3)}`].join(`
`)}function g(o){u.frame.textContent=`${o+1}`,u.time.textContent=r.t[o].toFixed(1),u.va.textContent=r.VA[o].toFixed(0),u.vb.textContent=r.VB[o].toFixed(0),u.vt.textContent=r.VTotal[o].toFixed(0),u.dt.textContent=r.dt.toFixed(2),u.stepSd.textContent=(a.diffusionSd*a.dt).toFixed(3),u.seed.textContent=`${M>>>0}`}function p(o){Mt(x,r,o,l.pointSize,n);const _=[{data:r.VA,color:"#f5b248"},{data:r.VB,color:n.type1Color},{data:r.VTotal,color:"#c68dff"}];if(n.withGoldman&&r.VGoldman){const N=new Float32Array(r.VGoldman.length);for(let $=0;$<r.VGoldman.length;$+=1)N[$]=r.VGoldman[$]*a.goldmanScale;_.push({data:N,color:"#f2f5fb",dashed:!0})}vt(c,r.t,o,_,r.t[r.t.length-1]||1,l.traceYLimit,"Membrane Potential Proxy Traces")}function b(o=!0){a=W(),l=f(),M=s(Math.floor(Number(t.seed.value)||M),0,4294967295)>>>0,r=ut(a,M,n),a={...a,boxWidth:r.boxWidth,boxHeight:r.boxHeight,wallThickness:r.rightWall-r.leftWall,negX:r.negX,negY:r.negY,type0YMin:r.type0YMin,type0YMax:r.type0YMax,type1YMin:r.type1YMin,type1YMax:r.type1YMax},o&&(Y=0),k(),S()}function T(){l=f(),k()}function V(o){P=o,i.togglePlay.textContent=P?"Pause":"Play"}k(),S(),g(0),p(0),i.togglePlay.addEventListener("click",()=>V(!P)),i.rerun.addEventListener("click",()=>b(!0)),i.rewind.addEventListener("click",()=>{Y=0,g(0),p(0)}),i.randomSeed.addEventListener("click",()=>{M=at(),v(t.seed,M,0),b(!0)}),i.resetDefaults.addEventListener("click",()=>{a={...e},l={...h},M=at(),k(),b(!0),V(!0)});const H=[t.numParticles,t.type0Fraction,t.diffusionSd,t.electricStrength,t.repulsionStrength,t.type0YMin,t.type0YMax,t.type1YMin,t.type1YMax,t.seed,t.totalTime,t.dt,t.boxWidth,t.boxHeight,t.wallThickness,t.negX,t.negY,t.initialLeftFrac,...t.goldmanScale?[t.goldmanScale]:[]];for(const o of H)o.addEventListener("change",()=>b(o!==t.seed));for(const o of[t.playbackSpeed,t.traceYLim,t.pointSize,t.targetFps])o.addEventListener("change",()=>T());window.addEventListener("resize",()=>p(Math.floor(Y)));function q(o){const _=(o-F)/1e3;F=o,P&&r.frames>0&&(Y+=_*l.targetFps*l.playbackSpeed,Y>=r.frames&&(Y%=r.frames));const N=s(Math.floor(Y),0,Math.max(0,r.frames-1));g(N),p(N),requestAnimationFrame(q)}requestAnimationFrame(o=>{F=o,q(o)})}export{Yt as m};
